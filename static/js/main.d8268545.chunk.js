(this["webpackJsonpsatisfactory-plant-designer"]=this["webpackJsonpsatisfactory-plant-designer"]||[]).push([[0],{576:function(e,t,c){},920:function(e,t,c){"use strict";c.r(t);var n=c(3),a=c(0),r=c.n(a),s=c(20),i=c.n(s),o=(c(576),c(996)),j=c(429),u=c(16),l=c(88),b=c(385),d=function e(t){var c=this;Object(l.a)(this,e),this.targetDataProvider=t,this.getList=function(e,t){return c.targetDataProvider.getList(e,t)},this.getOne=function(e,t){return c.targetDataProvider.getOne(e,t)},this.getMany=function(e,t){return c.targetDataProvider.getMany(e,t)},this.getManyReference=function(e,t){return c.targetDataProvider.getManyReference(e,t)},this.update=function(e,t){return c.targetDataProvider.update(e,t)},this.updateMany=function(e,t){return c.targetDataProvider.updateMany(e,t)},this.create=function(e,t){return c.targetDataProvider.create(e,t)},this.delete=function(e,t){return c.targetDataProvider.delete(e,t)},this.deleteMany=function(e,t){return c.targetDataProvider.deleteMany(e,t)}},O=function(e){var t=new d(Object(b.a)(e));return Object(u.a)(Object(u.a)({},t),{},{import:function(c){return localStorage.setItem(e.localStorageKey,JSON.stringify(c)),t.targetDataProvider=Object(b.a)(e),console.info("Successfully imported DB"),Promise.resolve({data:c})},export:function(){var t=localStorage.getItem(e.localStorageKey);return t?Promise.resolve({data:{db:JSON.parse(t),key:e.localStorageKey}}):Promise.resolve({data:{}})}})},f=c(1003),x=c(980),h=c(998),p=c(997),m=c(985),g=c(986),v=c(1004),y=c(1006),w=c(512),k=c(184),C=c(987),R=c(1007),D=c(316),P=c(66),S=c.n(P),L=["solid","liquid"].map((function(e){return{id:e,name:e}})),E=function(e){return Object(n.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)(x.a,{source:"q",alwaysOn:!0})}))},I=function(e){return Object(n.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(n.jsx)(E,{}),children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(m.a,{source:"id"}),Object(n.jsx)(m.a,{source:"name"}),Object(n.jsx)(m.a,{source:"type"}),Object(n.jsx)(D.ColorField,{source:"color"}),Object(n.jsx)(g.a,{})]})}))},T=function(e){var t=e.record;return t?Object(n.jsxs)("span",{children:["Resource #",t.id," - ",t.name]}):null},V=function(e){return Object(n.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(n.jsx)(T,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(y.a,{children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(C.a,{choices:L,source:"type",validate:Object(k.k)(),defaultValue:"solid"}),Object(n.jsx)(D.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},B=function(e){return Object(n.jsx)(R.a,Object(u.a)(Object(u.a)({title:"Create a Resource"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(y.a,{children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(C.a,{choices:L,source:"type",defaultValue:"solid"}),Object(n.jsx)(D.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},M=c(988),N=c(989),F=c(1008),J=c(1002),q=function(e){return Object(n.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)(x.a,{source:"q",alwaysOn:!0})}))},A=function(e){return Object(n.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(n.jsx)(q,{}),children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(m.a,{source:"id"}),Object(n.jsx)(m.a,{source:"name"}),Object(n.jsx)(M.a,{source:"powerConsumption"}),Object(n.jsx)(g.a,{})]})}))},K=function(e){var t=e.record;return t?Object(n.jsxs)("span",{children:["Building #",t.id," - ",t.name]}):null},G=function(e){return Object(n.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(n.jsx)(K,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(y.a,{children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(N.a,{source:"powerConsumption",validate:Object(k.k)()}),Object(n.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(n.jsx)(J.a,{children:Object(n.jsx)(C.a,{choices:L})})}),Object(n.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(n.jsx)(J.a,{children:Object(n.jsx)(C.a,{choices:L})})})]})}))},U=function(e){return Object(n.jsx)(R.a,Object(u.a)(Object(u.a)({title:"Create a Building"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(y.a,{children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(N.a,{source:"powerConsumption",validate:Object(k.k)()}),Object(n.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(n.jsx)(J.a,{children:Object(n.jsx)(C.a,{choices:L})})}),Object(n.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(n.jsx)(J.a,{children:Object(n.jsx)(C.a,{choices:L})})})]})}))},_=c(35),z=c(990),H=c(991),W=c(992),Z=c(1005),Q=c(1e3),X=c(1009),Y=c(1010),$=c(19),ee=c(199),te=c.n(ee),ce=c(200),ne=c(136),ae=c(526),re=c(83),se=c(529),ie=c(530),oe=c(56),je=function e(t,c,n,a,r){Object(l.a)(this,e),this.id=t,this.name=c,this.inputs=n,this.outputs=a,this.building=r};function ue(e,t){return Promise.all([t.getOne("buildings",{id:e.building}),t.getMany("resources",{ids:e.inputs.filter(Object(P.negate)(P.isNil)).map((function(e){return e.resource}))}),t.getMany("resources",{ids:e.outputs.filter(Object(P.negate)(P.isNil)).map((function(e){return e.resource}))})]).then((function(t){var c=Object(ce.a)(t,3),n=c[0].data,a=c[1].data,r=c[2].data,s=e.inputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return le(e,a)})),i=e.outputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return le(e,r)})),o=n;return new je(e.id,e.name,s,i,o)}))}function le(e,t){var c=t.find((function(t){return t.id===e.resource}));if(!c)throw new Error("missing resource ".concat(e.resource));return Object(u.a)(Object(u.a)({},e),{},{resource:c})}var be=c(67),de=Object(be.a)({container:{height:"auto",marginTop:0,flex:1}}),Oe=function(e){var t=e.graph,c=Object(oe.i)().fitView;return Object(n.jsxs)(oe.g,{maxZoom:10,onLoad:function(){return c()},snapToGrid:!0,nodesConnectable:!1,nodesDraggable:!0,elementsSelectable:!1,elements:t.getLayoutedElements(),children:[Object(n.jsx)(oe.d,{showInteractive:!1}),Object(n.jsx)(oe.b,{variant:oe.c.Dots,gap:12,size:1})]})},fe=c(528),xe=c(382),he=c.n(xe),pe=c(383),me=c.n(pe),ge=function(){function e(t,c){Object(l.a)(this,e),this.nodes=t,this.edges=c}return Object(fe.a)(e,[{key:"getElements",value:function(){return[].concat(Object(ne.a)(this.nodes),Object(ne.a)(this.edges))}},{key:"getLayoutedElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LR",t=this.getElements(),c=new he.a.graphlib.Graph({directed:!0});c.setDefaultEdgeLabel((function(){return{}}));var n="LR"===e;return c.setGraph({rankdir:e}),t.forEach((function(e){Object(oe.h)(e)?c.setNode(e.id,{width:150,height:50}):c.setEdge(e.source,e.target,{width:e.label?5*e.label.length+20:50,height:50})})),he.a.layout(c),t.map((function(e){if(Object(oe.h)(e)){var t=c.node(e.id);e.targetPosition=n?oe.e.Left:oe.e.Top,e.sourcePosition=n?oe.e.Right:oe.e.Bottom,e.position={x:t.x,y:t.y}}return e}))}}]),e}();function ve(e,t){return"".concat(e,"_").concat(t.resource.id)}function ye(e){return"building_".concat(e.id)}function we(e,t,c){return"input"===e?"".concat(t.resource.id,"->").concat(c.id):"".concat(c.id,"->").concat(t.resource.id)}function ke(e,t){return function(c){return{id:we(t,c,e),source:"input"===t?ve(t,c):ye(e),target:"input"===t?ye(e):ve(t,c),label:"".concat(c.flowRate),animated:!0,type:"smoothstep",arrowHeadType:oe.a.Arrow}}}function Ce(e){return function(t){return{id:ve(e,t),data:{label:t.resource.name,flow:t},position:{x:0,y:0},type:e,style:{backgroundColor:t.resource.color,borderColor:me()(t.resource.color),color:me()(t.resource.color,!0)}}}}function Re(){return(Re=Object(ae.a)(te.a.mark((function e(t,c){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(t,c);case 2:return n=e.sent,e.abrupt("return",De(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(e){var t={id:ye(e.building),data:{label:e.building.name},position:{x:0,y:0}},c=e.inputs.map(Ce("input")),n=e.outputs.map(Ce("output")),a=e.inputs.map(ke(e.building,"input")),r=e.outputs.map(ke(e.building,"output"));return new ge([t].concat(Object(ne.a)(c),Object(ne.a)(n)),[].concat(Object(ne.a)(a),Object(ne.a)(r)))}var Pe=function(e){var t=e.dryRecipe,c=de(),r=Object(re.a)(),s=Object(a.useState)(),i=Object(ce.a)(s,2),o=i[0],j=i[1],u=Object(a.useState)(!0),l=Object(ce.a)(u,2),b=l[0],d=l[1],O=Object(a.useState)(),f=Object(ce.a)(O,2),x=f[0],h=f[1];return Object(a.useEffect)((function(){t&&function(e,t){return Re.apply(this,arguments)}(t,r).then((function(e){j(e),d(!1)})).catch((function(e){h(e),d(!1)}))}),[r,t]),b?Object(n.jsx)(se.a,{classes:c}):x?Object(n.jsx)(ie.a,{error:x}):o?Object(n.jsx)(Oe,{graph:o}):null},Se=function(e){var t=e.dryRecipe;return Object(n.jsx)(oe.f,{children:Object(n.jsx)(Pe,{dryRecipe:t})})},Le=function(e){return Object(n.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)(x.a,{source:"q",alwaysOn:!0})}))},Ee=function(e){return Object(n.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(n.jsx)(Le,{}),children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(m.a,{source:"id"}),Object(n.jsx)(m.a,{source:"name"}),Object(n.jsx)(z.a,{source:"inputs",children:Object(n.jsx)(H.a,{children:Object(n.jsx)(W.a,{label:"Input",source:"resource",reference:"resources",children:Object(n.jsx)(Z.a,{source:"name"})})})}),Object(n.jsx)(z.a,{source:"outputs",children:Object(n.jsx)(H.a,{children:Object(n.jsx)(W.a,{label:"Output",source:"resource",reference:"resources",children:Object(n.jsx)(Z.a,{source:"name"})})})}),Object(n.jsx)(W.a,{label:"Building",source:"building",reference:"buildings",children:Object(n.jsx)(m.a,{source:"name"})}),Object(n.jsx)(g.a,{})]})}))},Ie=function(e){var t=e.record;return t?Object(n.jsxs)("span",{children:["Recipe #",t.id," - ",t.name]}):null},Te=function(){var e=Object(_.f)().values;return Object(n.jsx)(Se,{dryRecipe:e})},Ve=Object(be.a)((function(){return{root:{display:"contents"},main:{flexDirection:"column",flex:1},card:{flex:1,flexDirection:"column",display:"flex"}}})),Be=Object(be.a)((function(){return{form:{display:"contents"},content:{display:"flex",flexDirection:"column",flex:1}}})),Me=Object(be.a)((function(){return{formTabContainer:{display:"contents"},graphField:{display:"contents"},form:{display:"contents"}}}));var Ne=function(e){var t=Object($.h)(),c=Me(),a=Ve(),r=Be(),s=function(e){return e.pathname.split("/")[3]}(t);return Object(n.jsx)(v.a,Object(u.a)(Object(u.a)({classes:"design"===s?a:null,title:Object(n.jsx)(Ie,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(Q.a,{className:"design"===s?c.form:void 0,classes:"design"===s?r:null,children:[Object(n.jsxs)(X.a,{label:"Properties",children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})}),Object(n.jsx)(N.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(n.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})}),Object(n.jsx)(N.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(n.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})})]}),Object(n.jsx)(X.a,{contentClassName:c.formTabContainer,label:"Design",path:"design",children:"design"===s?Object(n.jsx)(Te,{formClassName:c.graphField,source:"design"}):void 0})]})}))},Fe=function(e){return Object(n.jsx)(R.a,Object(u.a)(Object(u.a)({title:"Create a Recipe"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(n.jsxs)(y.a,{children:[Object(n.jsx)(w.a,{source:"id"}),Object(n.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(n.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})}),Object(n.jsx)(N.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(n.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})}),Object(n.jsx)(N.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(n.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(k.k)(),children:Object(n.jsx)(C.a,{optionText:"name"})})]})}))},Je=c(999),qe=c(993),Ae=c(101),Ke=c(982),Ge=c(994),Ue=c(984),_e=c(548),ze=c(533),He=c.n(ze),We=c(534),Ze=c.n(We),Qe=c(90),Xe=function(){var e=Object(re.a)(),t=Object(Qe.a)();return Object(n.jsx)(Je.a,{mt:2,children:Object(n.jsxs)(qe.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"stretch",spacing:3,children:[Object(n.jsx)(qe.a,{item:!0,children:Object(n.jsx)(Ae.a,{variant:"h3",component:"h1",children:"Welcome to the generic building game plant designer"})}),Object(n.jsx)(qe.a,{item:!0,children:Object(n.jsxs)(Ke.a,{children:[Object(n.jsx)(Ge.a,{title:"Import/Export DB"}),Object(n.jsx)(Ue.a,{children:Object(n.jsxs)(qe.a,{container:!0,spacing:1,children:[Object(n.jsxs)(qe.a,{item:!0,children:[Object(n.jsx)("input",{accept:"application/json",id:"contained-button-file",style:{display:"none"},type:"file",onChange:function(c){var n,a=null===(n=c.target.files)||void 0===n?void 0:n[0];if(a){var r=new FileReader;r.onload=function(n){var a,r=null===(a=n.target)||void 0===a?void 0:a.result;if(r&&"string"===typeof r){var s=JSON.parse(r);e.import(s).then((function(){c.target.value="",t("Import successful")}))}else console.error("Could not read file")},r.readAsText(a,"utf-8")}}}),Object(n.jsx)("label",{htmlFor:"contained-button-file",children:Object(n.jsx)(_e.a,{variant:"contained",startIcon:Object(n.jsx)(He.a,{}),component:"span",children:"Import"})})]}),Object(n.jsx)(qe.a,{item:!0,children:Object(n.jsx)(_e.a,{variant:"contained",startIcon:Object(n.jsx)(Ze.a,{}),onClick:function(c){e.export().then((function(e){var c=e.data,n=c.db,a=c.key;if(n){var r=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),s=document.createElement("a");s.style.display="none",document.body.appendChild(s),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(r,"".concat(a,".json")):(s.setAttribute("href",URL.createObjectURL(r)),s.setAttribute("download","".concat(a,".json")),s.click())}else t("Empty database")}))},children:"Export"})})]})})]})})]})})},Ye=c(386),$e=c(995),et=function(e){return Object(n.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)(x.a,{source:"q",alwaysOn:!0})}))},tt=function(e){var t=e.record,c=e.renderLabel,a=Object(Ye.a)(e,["record","renderLabel"]);return Object(n.jsx)(Z.a,Object(u.a)(Object(u.a)({},a),{},{record:{id:c(t)},source:"id"}))},ct=function(e){var t=e.record,c=Object(Ye.a)(e,["record"]);return Object(n.jsx)(W.a,Object(u.a)(Object(u.a)({record:t},c),{},{source:"resource",reference:"resources",label:"Input",children:Object(n.jsx)(tt,{renderLabel:function(e){return"".concat(e.name," (").concat(null===t||void 0===t?void 0:t.flowRate,")")}})}))},nt=Object(be.a)((function(e){return{link:{color:e.palette.primary.main}}}),{name:"RaReferenceField"}),at=function(e){var t=nt();return Object(n.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(n.jsx)(et,{}),children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(m.a,{source:"id"}),Object(n.jsx)(m.a,{source:"name"}),Object(n.jsx)(z.a,{source:"targetResources",children:Object(n.jsx)(H.a,{children:Object(n.jsx)(ct,{})})}),Object(n.jsx)($e.a,{label:"Recipes",reference:"recipes",source:"recipes",children:Object(n.jsx)(H.a,{children:Object(n.jsx)(Z.a,{className:t.link,source:"name"})})})]})}))},rt=O({defaultData:{},localStorageKey:"plantDesigner",localStorageUpdateDelay:0,loggingEnabled:!0}),st=function(){return Object(n.jsxs)(o.a,{dataProvider:rt,dashboard:Xe,children:[Object(n.jsx)(j.a,{name:"resources",list:I,create:B,edit:V}),Object(n.jsx)(j.a,{name:"buildings",list:A,create:U,edit:G}),Object(n.jsx)(j.a,{name:"recipes",list:Ee,create:Fe,edit:Ne}),Object(n.jsx)(j.a,{name:"plants",list:at})]})},it=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,1013)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(st,{})}),document.getElementById("root")),it()}},[[920,1,2]]]);
//# sourceMappingURL=main.d8268545.chunk.js.map