(this["webpackJsonpsatisfactory-plant-designer"]=this["webpackJsonpsatisfactory-plant-designer"]||[]).push([[0],{573:function(e,t,a){},917:function(e,t,a){"use strict";a.r(t);var c=a(5),r=a(0),n=a.n(r),i=a(19),s=a.n(i),o=(a(573),a(992)),j=a(426),u=a(21),l=a(185),d=a(384),b=function e(t){var a=this;Object(l.a)(this,e),this.targetDataProvider=t,this.getList=function(e,t){return a.targetDataProvider.getList(e,t)},this.getOne=function(e,t){return a.targetDataProvider.getOne(e,t)},this.getMany=function(e,t){return a.targetDataProvider.getMany(e,t)},this.getManyReference=function(e,t){return a.targetDataProvider.getManyReference(e,t)},this.update=function(e,t){return a.targetDataProvider.update(e,t)},this.updateMany=function(e,t){return a.targetDataProvider.updateMany(e,t)},this.create=function(e,t){return a.targetDataProvider.create(e,t)},this.delete=function(e,t){return a.targetDataProvider.delete(e,t)},this.deleteMany=function(e,t){return a.targetDataProvider.deleteMany(e,t)}},O=function(e){var t=new b(Object(d.a)(e));return Object(u.a)(Object(u.a)({},t),{},{import:function(a){return localStorage.setItem(e.localStorageKey,JSON.stringify(a)),t.targetDataProvider=Object(d.a)(e),console.info("Successfully imported DB"),Promise.resolve({data:a})},export:function(){var t=localStorage.getItem(e.localStorageKey);return t?Promise.resolve({data:{db:JSON.parse(t),key:e.localStorageKey}}):{}}})},x=a(999),f=a(977),h=a(994),p=a(993),g=a(982),m=a(983),v=a(1e3),y=a(1002),w=a(509),k=a(182),C=a(984),D=a(1003),P=a(312),R=a(64),S=a.n(R),I=["solid","liquid"].map((function(e){return{id:e,name:e}})),L=function(e){return Object(c.jsx)(x.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(f.a,{source:"q",alwaysOn:!0})}))},T=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(L,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(g.a,{source:"id"}),Object(c.jsx)(g.a,{source:"name"}),Object(c.jsx)(g.a,{source:"type"}),Object(c.jsx)(P.ColorField,{source:"color"}),Object(c.jsx)(m.a,{})]})}))},V=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Resource #",t.id," - ",t.name]}):null},E=function(e){return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(c.jsx)(V,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(C.a,{choices:I,source:"type",validate:Object(k.k)(),defaultValue:"solid"}),Object(c.jsx)(P.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},M=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Resource"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(C.a,{choices:I,source:"type",defaultValue:"solid"}),Object(c.jsx)(P.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},B=a(985),F=a(986),N=a(1004),J=a(998),A=function(e){return Object(c.jsx)(x.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(f.a,{source:"q",alwaysOn:!0})}))},q=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(A,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(g.a,{source:"id"}),Object(c.jsx)(g.a,{source:"name"}),Object(c.jsx)(B.a,{source:"powerConsumption"}),Object(c.jsx)(m.a,{})]})}))},K=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Building #",t.id," - ",t.name]}):null},G=function(e){return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(c.jsx)(K,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(F.a,{source:"powerConsumption",validate:Object(k.k)()}),Object(c.jsx)(N.a,{source:"inputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(C.a,{choices:I})})}),Object(c.jsx)(N.a,{source:"outputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(C.a,{choices:I})})})]})}))},U=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Building"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(F.a,{source:"powerConsumption",validate:Object(k.k)()}),Object(c.jsx)(N.a,{source:"inputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(C.a,{choices:I})})}),Object(c.jsx)(N.a,{source:"outputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(C.a,{choices:I})})})]})}))},H=a(35),_=a(987),z=a(988),W=a(989),Z=a(1001),Q=a(996),X=a(1005),Y=a(1006),$=a(229),ee=a(157),te=a(523),ae=a(81),ce=a(525),re=a(526),ne=a(65),ie=a(381),se=a.n(ie),oe=a(382),je=a.n(oe);function ue(e,t){var a=t.find((function(t){return t.id===e.resource}));if(!a)throw new Error("missing resource ".concat(e.resource));return Object(u.a)(Object(u.a)({},e),{},{resource:a})}function le(e){return function(t){return{id:"input_".concat(t.resource.id),data:{label:t.resource.name,flow:t},position:{x:0,y:0},type:e,style:{backgroundColor:t.resource.color,borderColor:se()(t.resource.color),color:se()(t.resource.color,!0)}}}}var de=function(){function e(t,a){Object(l.a)(this,e),this.nodes=t,this.edges=a}return Object(te.a)(e,[{key:"getLayoutedElements",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LR",a=new je.a.graphlib.Graph({directed:!0});a.setDefaultEdgeLabel((function(){return{}}));var c="LR"===t;return a.setGraph({rankdir:t}),e.forEach((function(e){Object(ne.g)(e)?a.setNode(e.id,{width:150,height:50}):a.setEdge(e.source,e.target,{width:e.label?10*e.label.length:50,height:50})})),je.a.layout(a),e.map((function(e){if(Object(ne.g)(e)){var t=a.node(e.id);e.targetPosition=c?ne.e.Left:ne.e.Top,e.sourcePosition=c?ne.e.Right:ne.e.Bottom,e.position={x:t.x+Math.random()/1e3,y:t.y}}return e}))}([].concat(Object(ee.a)(this.nodes),Object(ee.a)(this.edges)))}}]),e}(),be=function(e){e.fitView()},Oe=function(e){var t=e.dryRecipe,a=Object(ae.a)(),n=Object(r.useState)(),i=Object($.a)(n,2),s=i[0],o=i[1],j=Object(r.useState)(!0),u=Object($.a)(j,2),l=u[0],d=u[1],b=Object(r.useState)(),O=Object($.a)(b,2),x=O[0],f=O[1];return Object(r.useEffect)((function(){t&&Promise.all([a.getOne("buildings",{id:t.building}),a.getMany("resources",{ids:t.inputs.filter(S.a.negate(S.a.isNil)).map((function(e){return e.resource}))}),a.getMany("resources",{ids:t.outputs.filter(S.a.negate(S.a.isNil)).map((function(e){return e.resource}))})]).then((function(e){var a=Object($.a)(e,3),c=a[0].data,r=a[1].data,n=a[2].data,i=t.inputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return ue(e,r)})),s=t.outputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return ue(e,n)})),j={id:"building_".concat(c.id),data:{label:c.name},position:{x:0,y:0}},u=i.map(le("input")),l=s.map(le("output")),b=u.map((function(e){return{id:"".concat(e.id,"->").concat(j.id),source:e.id,target:j.id,label:e.data&&"".concat(e.data.flow.flowRate),animated:!0,type:"smoothstep",arrowHeadType:ne.a.Arrow}})),O=l.map((function(e){return{id:"".concat(j.id,"->").concat(e.id),source:j.id,target:e.id,label:e.data&&"".concat(e.data.flow.flowRate),animated:!0,type:"smoothstep",arrowHeadType:ne.a.Arrow}})),x=new de([j].concat(Object(ee.a)(u),Object(ee.a)(l)),[].concat(Object(ee.a)(b),Object(ee.a)(O)));o(x),d(!1)})).catch((function(e){f(e),d(!1)}))}),[a,t]),l?Object(c.jsx)(ce.a,{}):x?Object(c.jsx)(re.a,{error:x}):s?Object(c.jsx)("div",{style:{position:"relative",height:500,width:"100%"},children:Object(c.jsxs)(ne.f,{maxZoom:3,onLoad:be,snapToGrid:!0,nodesConnectable:!1,nodesDraggable:!1,elementsSelectable:!1,elements:s.getLayoutedElements(),children:[Object(c.jsx)(ne.d,{showInteractive:!1}),Object(c.jsx)(ne.b,{variant:ne.c.Dots,gap:12,size:1})]})}):null},xe=function(e){return Object(c.jsx)(x.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(f.a,{source:"q",alwaysOn:!0})}))},fe=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(xe,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(g.a,{source:"id"}),Object(c.jsx)(g.a,{source:"name"}),Object(c.jsx)(_.a,{source:"inputs",children:Object(c.jsx)(z.a,{children:Object(c.jsx)(W.a,{label:"Input",source:"resource",reference:"resources",children:Object(c.jsx)(Z.a,{source:"name"})})})}),Object(c.jsx)(_.a,{source:"outputs",children:Object(c.jsx)(z.a,{children:Object(c.jsx)(W.a,{label:"Output",source:"resource",reference:"resources",children:Object(c.jsx)(Z.a,{source:"name"})})})}),Object(c.jsx)(W.a,{label:"Building",source:"building",reference:"buildings",children:Object(c.jsx)(g.a,{source:"name"})}),Object(c.jsx)(m.a,{})]})}))},he=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Recipe #",t.id," - ",t.name]}):null},pe=function(){var e=Object(H.f)().values;return Object(c.jsx)(Oe,{dryRecipe:e})},ge=function(e){return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(c.jsx)(he,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(Q.a,{children:[Object(c.jsxs)(X.a,{label:"Properties",children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(N.a,{source:"inputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})}),Object(c.jsx)(F.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(c.jsx)(N.a,{source:"outputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})}),Object(c.jsx)(F.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(c.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})})]}),Object(c.jsx)(X.a,{label:"Design",children:Object(c.jsx)(pe,{})})]})}))},me=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Recipe"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(k.k)()}),Object(c.jsx)(N.a,{source:"inputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})}),Object(c.jsx)(F.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(c.jsx)(N.a,{source:"outputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})}),Object(c.jsx)(F.a,{source:"flowRate",validate:Object(k.k)()})]})}),Object(c.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(k.k)(),children:Object(c.jsx)(C.a,{optionText:"name"})})]})}))},ve=a(995),ye=a(990),we=a(99),ke=a(979),Ce=a(991),De=a(981),Pe=a(544),Re=a(529),Se=a.n(Re),Ie=a(530),Le=a.n(Ie),Te=a(95),Ve=function(){var e=Object(ae.a)(),t=Object(Te.a)();return Object(c.jsx)(ve.a,{mt:2,children:Object(c.jsxs)(ye.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"stretch",spacing:3,children:[Object(c.jsx)(ye.a,{item:!0,children:Object(c.jsx)(we.a,{variant:"h3",component:"h1",children:"Welcome to the generic building game plant designer"})}),Object(c.jsx)(ye.a,{item:!0,children:Object(c.jsxs)(ke.a,{children:[Object(c.jsx)(Ce.a,{title:"Import/Export DB"}),Object(c.jsx)(De.a,{children:Object(c.jsxs)(ye.a,{container:!0,spacing:1,children:[Object(c.jsxs)(ye.a,{item:!0,children:[Object(c.jsx)("input",{accept:"application/json",id:"contained-button-file",style:{display:"none"},type:"file",onChange:function(a){var c,r=null===(c=a.target.files)||void 0===c?void 0:c[0];if(r){var n=new FileReader;n.onload=function(c){var r,n=null===(r=c.target)||void 0===r?void 0:r.result;if(n&&"string"===typeof n){var i=JSON.parse(n);e.import(i).then((function(){a.target.value="",t("Import successful")}))}else console.error("Could not read file")},n.readAsText(r,"utf-8")}}}),Object(c.jsx)("label",{htmlFor:"contained-button-file",children:Object(c.jsx)(Pe.a,{variant:"contained",startIcon:Object(c.jsx)(Se.a,{}),component:"span",children:"Import"})})]}),Object(c.jsx)(ye.a,{item:!0,children:Object(c.jsx)(Pe.a,{variant:"contained",startIcon:Object(c.jsx)(Le.a,{}),onClick:function(t){e.export().then((function(e){var t=e.data,a=t.db,c=t.key;if(a){var r=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),n=document.createElement("a");n.style.display="none",document.body.appendChild(n),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(r,"".concat(c,".json")):(n.setAttribute("href",URL.createObjectURL(r)),n.setAttribute("download","".concat(c,".json")),n.click())}}))},children:"Export"})})]})})]})})]})})},Ee=O({defaultData:{},localStorageKey:"plantDesigner",localStorageUpdateDelay:0,loggingEnabled:!0}),Me=function(){return Object(c.jsxs)(o.a,{dataProvider:Ee,dashboard:Ve,children:[Object(c.jsx)(j.a,{name:"resources",list:T,create:M,edit:E}),Object(c.jsx)(j.a,{name:"buildings",list:q,create:U,edit:G}),Object(c.jsx)(j.a,{name:"recipes",list:fe,create:me,edit:ge})]})},Be=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,1009)).then((function(t){var a=t.getCLS,c=t.getFID,r=t.getFCP,n=t.getLCP,i=t.getTTFB;a(e),c(e),r(e),n(e),i(e)}))};s.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(Me,{})}),document.getElementById("root")),Be()}},[[917,1,2]]]);
//# sourceMappingURL=main.e3eeae6e.chunk.js.map