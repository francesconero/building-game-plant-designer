(this["webpackJsonpsatisfactory-plant-designer"]=this["webpackJsonpsatisfactory-plant-designer"]||[]).push([[0],{573:function(e,t,a){},917:function(e,t,a){"use strict";a.r(t);var c=a(5),n=a(0),r=a.n(n),i=a(19),s=a.n(i),o=(a(573),a(992)),j=a(426),u=a(21),l=a(185),d=a(384),b=function e(t){var a=this;Object(l.a)(this,e),this.targetDataProvider=t,this.getList=function(e,t){return a.targetDataProvider.getList(e,t)},this.getOne=function(e,t){return a.targetDataProvider.getOne(e,t)},this.getMany=function(e,t){return a.targetDataProvider.getMany(e,t)},this.getManyReference=function(e,t){return a.targetDataProvider.getManyReference(e,t)},this.update=function(e,t){return a.targetDataProvider.update(e,t)},this.updateMany=function(e,t){return a.targetDataProvider.updateMany(e,t)},this.create=function(e,t){return a.targetDataProvider.create(e,t)},this.delete=function(e,t){return a.targetDataProvider.delete(e,t)},this.deleteMany=function(e,t){return a.targetDataProvider.deleteMany(e,t)}},O=function(e){var t=new b(Object(d.a)(e));return Object(u.a)(Object(u.a)({},t),{},{import:function(a){return localStorage.setItem(e.localStorageKey,JSON.stringify(a)),t.targetDataProvider=Object(d.a)(e),console.info("Successfully imported DB"),Promise.resolve({data:a})},export:function(){var t=localStorage.getItem(e.localStorageKey);return t?Promise.resolve({data:{db:JSON.parse(t),key:e.localStorageKey}}):{}}})},f=a(999),x=a(977),h=a(994),p=a(993),m=a(982),g=a(983),v=a(1e3),y=a(1002),w=a(509),C=a(182),k=a(984),D=a(1003),R=a(312),P=a(65),S=a.n(P),T=["solid","liquid"].map((function(e){return{id:e,name:e}})),I=function(e){return Object(c.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(x.a,{source:"q",alwaysOn:!0})}))},L=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(I,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(m.a,{source:"id"}),Object(c.jsx)(m.a,{source:"name"}),Object(c.jsx)(m.a,{source:"type"}),Object(c.jsx)(R.ColorField,{source:"color"}),Object(c.jsx)(g.a,{})]})}))},V=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Resource #",t.id," - ",t.name]}):null},E=function(e){return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(c.jsx)(V,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(k.a,{choices:T,source:"type",validate:Object(C.k)(),defaultValue:"solid"}),Object(c.jsx)(R.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},B=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Resource"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(k.a,{choices:T,source:"type",defaultValue:"solid"}),Object(c.jsx)(R.ColorInput,{source:"color",defaultValue:"#000000"})]})}))},M=a(985),N=a(986),F=a(1004),J=a(998),A=function(e){return Object(c.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(x.a,{source:"q",alwaysOn:!0})}))},q=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(A,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(m.a,{source:"id"}),Object(c.jsx)(m.a,{source:"name"}),Object(c.jsx)(M.a,{source:"powerConsumption"}),Object(c.jsx)(g.a,{})]})}))},K=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Building #",t.id," - ",t.name]}):null},G=function(e){return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({title:Object(c.jsx)(K,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(N.a,{source:"powerConsumption",validate:Object(C.k)()}),Object(c.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(k.a,{choices:T})})}),Object(c.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(k.a,{choices:T})})})]})}))},U=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Building"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(N.a,{source:"powerConsumption",validate:Object(C.k)()}),Object(c.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(k.a,{choices:T})})}),Object(c.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(c.jsx)(J.a,{children:Object(c.jsx)(k.a,{choices:T})})})]})}))},H=a(35),_=a(987),z=a(988),W=a(989),Z=a(1001),Q=a(996),X=a(1005),Y=a(1006),$=a(18),ee=a(229),te=a(157),ae=a(523),ce=a(81),ne=a(525),re=a(526),ie=a(58),se=a(381),oe=a.n(se),je=a(382),ue=a.n(je),le=a(76),de=Object(le.a)({container:{height:"auto",marginTop:0,flex:1}});function be(e,t){var a=t.find((function(t){return t.id===e.resource}));if(!a)throw new Error("missing resource ".concat(e.resource));return Object(u.a)(Object(u.a)({},e),{},{resource:a})}function Oe(e){return function(t){return{id:"input_".concat(t.resource.id),data:{label:t.resource.name,flow:t},position:{x:0,y:0},type:e,style:{backgroundColor:t.resource.color,borderColor:oe()(t.resource.color),color:oe()(t.resource.color,!0)}}}}var fe=function(){function e(t,a){Object(l.a)(this,e),this.nodes=t,this.edges=a}return Object(ae.a)(e,[{key:"getLayoutedElements",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LR",a=new ue.a.graphlib.Graph({directed:!0});a.setDefaultEdgeLabel((function(){return{}}));var c="LR"===t;return a.setGraph({rankdir:t}),e.forEach((function(e){Object(ie.h)(e)?a.setNode(e.id,{width:150,height:50}):a.setEdge(e.source,e.target,{width:e.label?10*e.label.length:50,height:50})})),ue.a.layout(a),e.map((function(e){if(Object(ie.h)(e)){var t=a.node(e.id);e.targetPosition=c?ie.e.Left:ie.e.Top,e.sourcePosition=c?ie.e.Right:ie.e.Bottom,e.position={x:t.x,y:t.y}}return e}))}([].concat(Object(te.a)(this.nodes),Object(te.a)(this.edges)))}}]),e}(),xe=function(e){var t=e.dryRecipe,a=de(),r=Object(ce.a)(),i=Object(n.useState)(),s=Object(ee.a)(i,2),o=s[0],j=s[1],u=Object(n.useState)(!0),l=Object(ee.a)(u,2),d=l[0],b=l[1],O=Object(n.useState)(),f=Object(ee.a)(O,2),x=f[0],h=f[1],p=Object(ie.i)().fitView;return Object(n.useEffect)((function(){t&&Promise.all([r.getOne("buildings",{id:t.building}),r.getMany("resources",{ids:t.inputs.filter(S.a.negate(S.a.isNil)).map((function(e){return e.resource}))}),r.getMany("resources",{ids:t.outputs.filter(S.a.negate(S.a.isNil)).map((function(e){return e.resource}))})]).then((function(e){var a=Object(ee.a)(e,3),c=a[0].data,n=a[1].data,r=a[2].data,i=t.inputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return be(e,n)})),s=t.outputs.filter((function(e){return null===e||void 0===e?void 0:e.resource})).map((function(e){return be(e,r)})),o={id:"building_".concat(c.id),data:{label:c.name},position:{x:0,y:0}},u=i.map(Oe("input")),l=s.map(Oe("output")),d=u.map((function(e){return{id:"".concat(e.id,"->").concat(o.id),source:e.id,target:o.id,label:e.data&&"".concat(e.data.flow.flowRate),animated:!0,type:"smoothstep",arrowHeadType:ie.a.Arrow}})),O=l.map((function(e){return{id:"".concat(o.id,"->").concat(e.id),source:o.id,target:e.id,label:e.data&&"".concat(e.data.flow.flowRate),animated:!0,type:"smoothstep",arrowHeadType:ie.a.Arrow}})),f=new fe([o].concat(Object(te.a)(u),Object(te.a)(l)),[].concat(Object(te.a)(d),Object(te.a)(O)));j(f),b(!1)})).catch((function(e){h(e),b(!1)}))}),[r,t,p]),d?Object(c.jsx)(ne.a,{classes:a}):x?Object(c.jsx)(re.a,{error:x}):o?Object(c.jsxs)(ie.g,{maxZoom:10,onLoad:function(){return p()},snapToGrid:!0,nodesConnectable:!1,nodesDraggable:!1,elementsSelectable:!1,elements:o.getLayoutedElements(),children:[Object(c.jsx)(ie.d,{showInteractive:!1}),Object(c.jsx)(ie.b,{variant:ie.c.Dots,gap:12,size:1})]}):null},he=function(e){var t=e.dryRecipe;return Object(c.jsx)(ie.f,{children:Object(c.jsx)(xe,{dryRecipe:t})})},pe=function(e){return Object(c.jsx)(f.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(c.jsx)(x.a,{source:"q",alwaysOn:!0})}))},me=function(e){return Object(c.jsx)(h.a,Object(u.a)(Object(u.a)({},e),{},{filters:Object(c.jsx)(pe,{}),children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(m.a,{source:"id"}),Object(c.jsx)(m.a,{source:"name"}),Object(c.jsx)(_.a,{source:"inputs",children:Object(c.jsx)(z.a,{children:Object(c.jsx)(W.a,{label:"Input",source:"resource",reference:"resources",children:Object(c.jsx)(Z.a,{source:"name"})})})}),Object(c.jsx)(_.a,{source:"outputs",children:Object(c.jsx)(z.a,{children:Object(c.jsx)(W.a,{label:"Output",source:"resource",reference:"resources",children:Object(c.jsx)(Z.a,{source:"name"})})})}),Object(c.jsx)(W.a,{label:"Building",source:"building",reference:"buildings",children:Object(c.jsx)(m.a,{source:"name"})}),Object(c.jsx)(g.a,{})]})}))},ge=function(e){var t=e.record;return t?Object(c.jsxs)("span",{children:["Recipe #",t.id," - ",t.name]}):null},ve=function(){var e=Object(H.f)().values;return Object(c.jsx)(he,{dryRecipe:e})},ye=Object(le.a)((function(){return{root:{display:"contents"},main:{flexDirection:"column",flex:1},card:{flex:1,flexDirection:"column",display:"flex"}}})),we=Object(le.a)((function(){return{form:{display:"contents"},content:{display:"flex",flexDirection:"column",flex:1}}})),Ce=Object(le.a)((function(){return{formTabContainer:{display:"contents"},graphField:{display:"contents"},form:{display:"contents"}}}));var ke=function(e){var t=Object($.h)(),a=Ce(),n=ye(),r=we(),i=function(e){return e.pathname.split("/")[3]}(t);return Object(c.jsx)(v.a,Object(u.a)(Object(u.a)({classes:"design"===i?n:null,title:Object(c.jsx)(ge,{})},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(Q.a,{className:"design"===i?a.form:void 0,classes:"design"===i?r:null,children:[Object(c.jsxs)(X.a,{label:"Properties",children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})}),Object(c.jsx)(N.a,{source:"flowRate",validate:Object(C.k)()})]})}),Object(c.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})}),Object(c.jsx)(N.a,{source:"flowRate",validate:Object(C.k)()})]})}),Object(c.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})})]}),Object(c.jsx)(X.a,{contentClassName:a.formTabContainer,label:"Design",path:"design",children:"design"===i?Object(c.jsx)(ve,{formClassName:a.graphField,source:"design"}):void 0})]})}))},De=function(e){return Object(c.jsx)(D.a,Object(u.a)(Object(u.a)({title:"Create a Recipe"},e),{},{transform:function(e){return e.id?e:Object(u.a)(Object(u.a)({},e),{},{id:S.a.camelCase(e.name)})},children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(w.a,{source:"id"}),Object(c.jsx)(w.a,{source:"name",validate:Object(C.k)()}),Object(c.jsx)(F.a,{source:"inputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})}),Object(c.jsx)(N.a,{source:"flowRate",validate:Object(C.k)()})]})}),Object(c.jsx)(F.a,{source:"outputs",defaultValue:[],children:Object(c.jsxs)(J.a,{children:[Object(c.jsx)(Y.a,{label:"resource",source:"resource",reference:"resources",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})}),Object(c.jsx)(N.a,{source:"flowRate",validate:Object(C.k)()})]})}),Object(c.jsx)(Y.a,{label:"building",source:"building",reference:"buildings",validate:Object(C.k)(),children:Object(c.jsx)(k.a,{optionText:"name"})})]})}))},Re=a(995),Pe=a(990),Se=a(99),Te=a(979),Ie=a(991),Le=a(981),Ve=a(544),Ee=a(529),Be=a.n(Ee),Me=a(530),Ne=a.n(Me),Fe=a(95),Je=function(){var e=Object(ce.a)(),t=Object(Fe.a)();return Object(c.jsx)(Re.a,{mt:2,children:Object(c.jsxs)(Pe.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"stretch",spacing:3,children:[Object(c.jsx)(Pe.a,{item:!0,children:Object(c.jsx)(Se.a,{variant:"h3",component:"h1",children:"Welcome to the generic building game plant designer"})}),Object(c.jsx)(Pe.a,{item:!0,children:Object(c.jsxs)(Te.a,{children:[Object(c.jsx)(Ie.a,{title:"Import/Export DB"}),Object(c.jsx)(Le.a,{children:Object(c.jsxs)(Pe.a,{container:!0,spacing:1,children:[Object(c.jsxs)(Pe.a,{item:!0,children:[Object(c.jsx)("input",{accept:"application/json",id:"contained-button-file",style:{display:"none"},type:"file",onChange:function(a){var c,n=null===(c=a.target.files)||void 0===c?void 0:c[0];if(n){var r=new FileReader;r.onload=function(c){var n,r=null===(n=c.target)||void 0===n?void 0:n.result;if(r&&"string"===typeof r){var i=JSON.parse(r);e.import(i).then((function(){a.target.value="",t("Import successful")}))}else console.error("Could not read file")},r.readAsText(n,"utf-8")}}}),Object(c.jsx)("label",{htmlFor:"contained-button-file",children:Object(c.jsx)(Ve.a,{variant:"contained",startIcon:Object(c.jsx)(Be.a,{}),component:"span",children:"Import"})})]}),Object(c.jsx)(Pe.a,{item:!0,children:Object(c.jsx)(Ve.a,{variant:"contained",startIcon:Object(c.jsx)(Ne.a,{}),onClick:function(t){e.export().then((function(e){var t=e.data,a=t.db,c=t.key;if(a){var n=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),r=document.createElement("a");r.style.display="none",document.body.appendChild(r),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(n,"".concat(c,".json")):(r.setAttribute("href",URL.createObjectURL(n)),r.setAttribute("download","".concat(c,".json")),r.click())}}))},children:"Export"})})]})})]})})]})})},Ae=O({defaultData:{},localStorageKey:"plantDesigner",localStorageUpdateDelay:0,loggingEnabled:!0}),qe=function(){return Object(c.jsxs)(o.a,{dataProvider:Ae,dashboard:Je,children:[Object(c.jsx)(j.a,{name:"resources",list:L,create:B,edit:E}),Object(c.jsx)(j.a,{name:"buildings",list:q,create:U,edit:G}),Object(c.jsx)(j.a,{name:"recipes",list:me,create:De,edit:ke})]})},Ke=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,1009)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),c(e),n(e),r(e),i(e)}))};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(qe,{})}),document.getElementById("root")),Ke()}},[[917,1,2]]]);
//# sourceMappingURL=main.4203d8fa.chunk.js.map